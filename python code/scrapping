import requests
from bs4 import BeautifulSoup
import os

def download_image(url, player_name):
    response = requests.get(url)
    if response.status_code == 200:
        # Create images directory if it doesn't exist
        if not os.path.exists('chess_players_images'):
            os.makedirs('chess_players_images')
        
        # Save image
        file_name = f"chess_players_images/{player_name}.jpg"
        with open(file_name, 'wb') as f:
            f.write(response.content)
        print(f"Downloaded image for {player_name}")
    else:
        print(f"Failed to download image for {player_name}")

def scrape_chess_players():
    # FIDE's page for top Indian players
    url = "https://ratings.fide.com/top.phtml?list=men&country=IND"
    
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.content, 'html.parser')
        
        # Find player elements (this will need to be adjusted based on actual HTML structure)
        player_elements = soup.find_all('tr', class_='playerlist')
        
        for player in player_elements:
            try:
                # Extract player name and image URL (adjust selectors based on actual HTML)
                name = player.find('td', class_='name').text.strip()
                img_element = player.find('img')
                if img_element and 'src' in img_element.attrs:
                    img_url = img_element['src']
                    if not img_url.startswith('http'):
                        img_url = 'https://ratings.fide.com/' + img_url
                    download_image(img_url, name)
            except Exception as e:
                print(f"Error processing player: {str(e)}")
                
    except Exception as e:
        print(f"Error scraping website: {str(e)}")

if __name__ == "__main__":
    scrape_chess_players()